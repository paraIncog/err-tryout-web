import{p as Y,a as q,d as J,g as Q,e as X,i as Z,u as ee,w as te}from"./createSimplePaletteValueFilter-Cf9SvP4l.js";import{a as p,o as f,v as ne}from"./chunk-D4RADZKF-yoc3-3G9.js";import{e as re,u as se,T as k}from"./Typography-AnKalMGu.js";import{s as ie,u as oe}from"./useThemeProps-BmF9-Oss.js";function ae(e,t){var n,i,r;return p.isValidElement(e)&&t.indexOf(e.type.muiName??((r=(i=(n=e.type)==null?void 0:n._payload)==null?void 0:i.value)==null?void 0:r.muiName))!==-1}const ce=(e,t)=>e.filter(n=>t.includes(n)),b=(e,t,n)=>{const i=e.keys[0];Array.isArray(t)?t.forEach((r,s)=>{n((a,m)=>{s<=e.keys.length-1&&(s===0?Object.assign(a,m):a[e.up(e.keys[s])]=m)},r)}):t&&typeof t=="object"?(Object.keys(t).length>e.keys.length?e.keys:ce(e.keys,Object.keys(t))).forEach(s=>{if(e.keys.includes(s)){const a=t[s];a!==void 0&&n((m,g)=>{i===s?Object.assign(m,g):m[e.up(s)]=g},a)}}):(typeof t=="number"||typeof t=="string")&&n((r,s)=>{Object.assign(r,s)},t)};function T(e){return`--Grid-${e}Spacing`}function G(e){return`--Grid-parent-${e}Spacing`}const R="--Grid-columns",$="--Grid-parent-columns",ue=({theme:e,ownerState:t})=>{const n={};return b(e.breakpoints,t.size,(i,r)=>{let s={};r==="grow"&&(s={flexBasis:0,flexGrow:1,maxWidth:"100%"}),r==="auto"&&(s={flexBasis:"auto",flexGrow:0,flexShrink:0,maxWidth:"none",width:"auto"}),typeof r=="number"&&(s={flexGrow:0,flexBasis:"auto",width:`calc(100% * ${r} / var(${$}) - (var(${$}) - ${r}) * (var(${G("column")}) / var(${$})))`}),i(n,s)}),n},le=({theme:e,ownerState:t})=>{const n={};return b(e.breakpoints,t.offset,(i,r)=>{let s={};r==="auto"&&(s={marginLeft:"auto"}),typeof r=="number"&&(s={marginLeft:r===0?"0px":`calc(100% * ${r} / var(${$}) + var(${G("column")}) * ${r} / var(${$}))`}),i(n,s)}),n},de=({theme:e,ownerState:t})=>{if(!t.container)return{};const n={[R]:12};return b(e.breakpoints,t.columns,(i,r)=>{const s=r??12;i(n,{[R]:s,"> *":{[$]:s}})}),n},fe=({theme:e,ownerState:t})=>{if(!t.container)return{};const n={};return b(e.breakpoints,t.rowSpacing,(i,r)=>{var a;const s=typeof r=="string"?r:(a=e.spacing)==null?void 0:a.call(e,r);i(n,{[T("row")]:s,"> *":{[G("row")]:s}})}),n},me=({theme:e,ownerState:t})=>{if(!t.container)return{};const n={};return b(e.breakpoints,t.columnSpacing,(i,r)=>{var a;const s=typeof r=="string"?r:(a=e.spacing)==null?void 0:a.call(e,r);i(n,{[T("column")]:s,"> *":{[G("column")]:s}})}),n},pe=({theme:e,ownerState:t})=>{if(!t.container)return{};const n={};return b(e.breakpoints,t.direction,(i,r)=>{i(n,{flexDirection:r})}),n},ge=({ownerState:e})=>({minWidth:0,boxSizing:"border-box",...e.container&&{display:"flex",flexWrap:"wrap",...e.wrap&&e.wrap!=="wrap"&&{flexWrap:e.wrap},gap:`var(${T("row")}) var(${T("column")})`}}),ye=e=>{const t=[];return Object.entries(e).forEach(([n,i])=>{i!==!1&&i!==void 0&&t.push(`grid-${n}-${String(i)}`)}),t},Se=(e,t="xs")=>{function n(i){return i===void 0?!1:typeof i=="string"&&!Number.isNaN(Number(i))||typeof i=="number"&&i>0}if(n(e))return[`spacing-${t}-${String(e)}`];if(typeof e=="object"&&!Array.isArray(e)){const i=[];return Object.entries(e).forEach(([r,s])=>{n(s)&&i.push(`spacing-${r}-${String(s)}`)}),i}return[]},he=e=>e===void 0?[]:typeof e=="object"?Object.entries(e).map(([t,n])=>`direction-${t}-${n}`):[`direction-xs-${String(e)}`];function xe(e,t){e.item!==void 0&&delete e.item,e.zeroMinWidth!==void 0&&delete e.zeroMinWidth,t.keys.forEach(n=>{e[n]!==void 0&&delete e[n]})}const je=X(),$e=ie("div",{name:"MuiGrid",slot:"Root"});function be(e){return oe({props:e,name:"MuiGrid",defaultTheme:je})}function Te(e={}){const{createStyledComponent:t=$e,useThemeProps:n=be,useTheme:i=Y,componentName:r="MuiGrid"}=e,s=(u,c)=>{const{container:y,direction:o,spacing:l,wrap:d,size:x}=u,S={root:["root",y&&"container",d!=="wrap"&&`wrap-xs-${String(d)}`,...he(o),...ye(x),...y?Se(l,c.breakpoints.keys[0]):[]]};return J(S,w=>Q(r,w),{})};function a(u,c,y=()=>!0){const o={};return u===null||(Array.isArray(u)?u.forEach((l,d)=>{l!==null&&y(l)&&c.keys[d]&&(o[c.keys[d]]=l)}):typeof u=="object"?Object.keys(u).forEach(l=>{const d=u[l];d!=null&&y(d)&&(o[l]=d)}):o[c.keys[0]]=u),o}const m=t(de,me,fe,ue,pe,ge,le),g=p.forwardRef(function(c,y){const o=i(),l=n(c),d=re(l);xe(d,o.breakpoints);const{className:x,children:S,columns:w=12,container:C=!1,component:M="div",direction:O="row",wrap:A="wrap",size:z={},offset:B={},spacing:E=0,rowSpacing:D=E,columnSpacing:L=E,unstable_level:j=0,...U}=d,W=a(z,o.breakpoints,h=>h!==!1),I=a(B,o.breakpoints),_=c.columns??(j?void 0:w),H=c.spacing??(j?void 0:E),K=c.rowSpacing??c.spacing??(j?void 0:D),F=c.columnSpacing??c.spacing??(j?void 0:L),N={...d,level:j,columns:_,container:C,direction:O,wrap:A,spacing:H,rowSpacing:K,columnSpacing:F,size:W,offset:I},V=s(N,o);return f.jsx(m,{ref:y,as:M,ownerState:N,className:q(V.root,x),...U,children:p.Children.map(S,h=>{var P;return p.isValidElement(h)&&ae(h,["Grid"])&&C&&h.props.container?p.cloneElement(h,{unstable_level:((P=h.props)==null?void 0:P.unstable_level)??j+1}):h})})});return g.muiName="Grid",g}const v=Te({createStyledComponent:Z("div",{name:"MuiGrid",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.container&&t.container]}}),componentName:"MuiGrid",useThemeProps:e=>ee({props:e,name:"MuiGrid"}),useTheme:se}),Ge=({episodeList:e})=>{if(!e||e.length===0)return null;const t=e[0],n=p.useRef(null),[i,r]=p.useState(!1),[s,a]=p.useState(0),[m,g]=p.useState(t.duration||0),u=`episode-progress-${t.id}`,c=()=>{n.current&&(i?n.current.pause():n.current.play(),r(!i))},y=o=>{const l=Math.floor(o/60),d=Math.floor(o%60);return`${l.toString().padStart(2,"0")}:${d.toString().padStart(2,"0")}`};return p.useEffect(()=>{const o=n.current;if(!o)return;const l=localStorage.getItem(u);l&&(o.currentTime=parseFloat(l),a(o.currentTime));const d=()=>{const S=o.currentTime;a(S),localStorage.setItem(u,S.toString())},x=()=>{o.duration&&!isNaN(o.duration)&&g(o.duration)};return o.addEventListener("timeupdate",d),o.addEventListener("loadedmetadata",x),o.addEventListener("ended",()=>r(!1)),"mediaSession"in navigator&&t&&(navigator.mediaSession.metadata=new MediaMetadata({title:t.title,artist:"ERR",album:"ERR Raadio",artwork:[{src:t.imageUrl,sizes:"512x512",type:"image/png"}]}),navigator.mediaSession.setActionHandler("play",()=>{o.play(),r(!0)}),navigator.mediaSession.setActionHandler("pause",()=>{o.pause(),r(!1)}),navigator.mediaSession.setActionHandler("seekto",S=>{S.fastSeek&&"fastSeek"in o?o.fastSeek(S.seekTime):o.currentTime=S.seekTime??0,a(o.currentTime)})),()=>{o.removeEventListener("timeupdate",d),o.removeEventListener("loadedmetadata",x)}},[t]),f.jsxs("div",{children:[f.jsxs(v,{container:!0,spacing:2,alignItems:"center",justifyContent:"center",sx:{p:2},children:[f.jsx(v,{item:!0,xs:12,sm:5,sx:{textAlign:"center"},children:f.jsx("img",{src:t.imageUrl,alt:"Thumbnail",style:{maxWidth:"100%",maxHeight:"20rem",borderRadius:8}})}),f.jsxs(v,{item:!0,xs:12,sm:7,children:[f.jsxs(k,{variant:"body2",gutterBottom:!0,children:["Avaldatud: ",t.createdTime]}),f.jsx(k,{variant:"h5",gutterBottom:!0,children:t.title}),f.jsx(k,{variant:"subtitle1",gutterBottom:!0,children:t.description}),f.jsxs("div",{style:{display:"flex",alignItems:"center",marginTop:8},children:[f.jsx("button",{onClick:c,style:{marginRight:10},children:i?"⏸":"▶"}),f.jsx("span",{children:y(s)}),f.jsx("input",{type:"range",min:0,max:m,value:s,onChange:o=>{const l=Number(o.target.value);n.current&&(n.current.currentTime=l),a(l),localStorage.setItem(u,l.toString())},style:{flexGrow:1,margin:"0 8px"}}),f.jsx("span",{children:y(m)})]})]})]}),f.jsx("audio",{ref:n,src:t.audioUrl,preload:"metadata"})]})},Ce=te(function(){const{id:t}=ne(),[n,i]=p.useState(null);return p.useEffect(()=>{t&&fetch(`http://localhost:8080/api/content/range?from=${t}&to=${t}`).then(r=>r.json()).then(r=>{var s,a,m,g;if(r.length>0){const u=r[0],c=(s=u.medias)==null?void 0:s[0];i({id:u.id,title:u.heading,description:u.lead,imageUrl:(m=(a=u.photos)==null?void 0:a[0])==null?void 0:m.photoUrlOriginal,audioUrl:c==null?void 0:c.podcastUrl,duration:(c==null?void 0:c.duration)||240,createdTime:((g=u.formatedTimes)==null?void 0:g.created)||""})}})},[t]),n?f.jsx(Ge,{episodeList:[n]}):f.jsx("div",{children:"Loading..."})});export{Ce as default};
